
## Last commit: 2020-03-22 18:14:26 UTC by nornir
version 20191212.201431_builder.r1074901;
groups {
    GLOBAL_ISIS_DEFAULTS {
        protocols {
            isis {
                level 1 disable;
                level 2 wide-metrics-only;
                interface <*> {
                    hello-padding disable;
                }
                reference-bandwidth 1000g;
            }
        }
    }
    IRB_OPTIONS {
        interfaces {
            irb {
                unit <*> {
                    proxy-macip-advertisement;
                    virtual-gateway-accept-data;
                    family inet {
                        address <*> {
                            primary;
                            preferred;
                        }
                    }
                    virtual-gateway-v4-mac 00:5e:5e:5e:00:01;
                }
            }
        }
    }
}
system {
    host-name spine1;
    root-authentication {
        encrypted-password "$6$1BQBardo$nAiDclQReI4Zq2q2Z0EiIkMkqLK112R6QJZyvv3mDmn6q5NoXY9WAZMKEbKlpJNRwZ1qBEf5SqxaPq8Hu46CJ0";
        ssh-rsa "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key";
    }
    login {
        user nornir {
            uid 2001;
            class super-user;
            authentication {
                encrypted-password "$6$DCyoMC6o$8NzXXdAIX4pD93DMgfO/2gyltgXhqFbngkYTGhksksLIbJuvGjXn8IcQQahRBXkkBUWJgbGb9mweZikl1bzAX1";
            }
        }
        user vagrant {
            uid 2000;
            class super-user;
            authentication {
                ssh-rsa "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key";
            }
        }
    }
    services {
        ssh {
            root-login allow;
        }
        netconf {
            ssh;
        }
        rest {
            http {
                port 8080;
            }
            enable-explorer;
        }
    }
    syslog {
        user * {
            any emergency;
        }
        file messages {
            any notice;
            authorization info;
        }
        file interactive-commands {
            interactive-commands any;
        }
    }
    extensions {
        providers {
            juniper {
                license-type juniper deployment-scope commercial;
            }
            chef {
                license-type juniper deployment-scope commercial;
            }
        }
    }
}
interfaces {
    apply-groups IRB_OPTIONS;
    xe-0/0/1 {
        unit 0 {
            family inet {
                address 10.1.11.0/31;
            }
            family iso;
        }
    }
    xe-0/0/2 {
        unit 0 {
            family inet {
                address 10.1.12.0/31;
            }
            family iso;
        }
    }
    xe-0/0/3 {
        unit 0 {
            family inet {
                address 10.1.13.0/31;
            }
            family iso;
        }
    }
    xe-0/0/4 {
        unit 0 {
            family inet {
                address 10.1.14.0/31;
            }
            family iso;
        }
    }
    em0 {
        unit 0 {
            family inet {
                address 10.255.111.1/17;
            }
        }
    }
    em1 {
        unit 0 {
            family inet {
                address 169.254.0.2/24;
            }
        }
    }
    irb {
        unit 100 {
            family inet {
                address 10.100.100.2/24 {
                    virtual-gateway-address 10.100.100.1;
                }
            }
        }
    }
    lo0 {
        unit 0 {
            family inet {
                address 192.168.200.1/32;
            }
            family iso {
                address 49.0192.0168.0200.0001.00;
            }
        }
        unit 1 {
            family inet {
                address 192.168.222.1/32;
            }
        }
    }
}
forwarding-options {
    storm-control-profiles default {
        all;
    }
}
policy-options {
    prefix-list PREFIX_DEFAULT {
        0.0.0.0/0;
    }
    prefix-list PREFIX_LOOPBACK_IPV4 {
        apply-path "interfaces lo0 unit <*> family inet address <*>";
    }
    policy-statement EVPN_IMPORT {
        term 1 {
            from community ESI;
            then accept;
        }
    }
    policy-statement EXPORT_VRF_REDTAIL {
        term 1 {
            from interface irb.100;
            then {
                community add com100;
                accept;
            }
        }
    }
    policy-statement IMPORT_INET {
        term 1 {
            from community com100;
            then accept;
        }
    }
    policy-statement POLICY_DEFAULT {
        from {
            prefix-list PREFIX_DEFAULT;
        }
        then accept;
    }
    policy-statement POLICY_EXPORT_ROUTER_IPV4 {
        from {
            prefix-list PREFIX_LOOPBACK_IPV4;
        }
        then accept;
    }
    policy-statement POLICY_LB {
        term 10 {
            then {
                load-balance per-packet;
                accept;
            }
        }
    }
    community ESI members target:999:999;
    community com100 members target:1:100;
}
routing-instances {
    VRF_REDTAIL {
        routing-options {
            multipath;
            auto-export {
                family inet {
                    unicast;
                }
            }
        }
        instance-type vrf;
        interface irb.100;
        interface lo0.1;
        route-distinguisher 192.168.222.1:100;
        vrf-import IMPORT_INET;
        vrf-export EXPORT_VRF_REDTAIL;
        vrf-table-label;
    }
}
routing-options {
    forwarding-table {
        export POLICY_LB;
        ecmp-fast-reroute;
    }
    router-id 192.168.200.1;
    autonomous-system 100.0;
}
protocols {
    isis {
        apply-groups GLOBAL_ISIS_DEFAULTS;
        interface xe-0/0/1.0 {
            point-to-point;
        }
        interface xe-0/0/2.0 {
            point-to-point;
        }
        interface xe-0/0/3.0 {
            point-to-point;
        }
        interface xe-0/0/4.0 {
            point-to-point;
        }
        interface lo0.0 {
            passive;
        }
        export POLICY_EXPORT_ROUTER_IPV4;
    }
    evpn {
        encapsulation vxlan;
        default-gateway no-gateway-community;
        extended-vni-list all;
    }
    bgp {
        group LEAF_EVPN_OVERLAY {
            type internal;
            local-address 192.168.200.1;
            family evpn {
                signaling;
            }
            cluster 0.0.0.1;
            multipath;
            neighbor 192.168.200.11;
            neighbor 192.168.200.12;
            neighbor 192.168.200.13;
            neighbor 192.168.200.14;
        }
        group SPINES_ROUTE_REFLECTORS {
            type internal;
            local-address 192.168.200.1;
            family evpn {
                signaling;
            }
            neighbor 192.168.200.2;
        }
    }
    igmp-snooping {
        vlan default;
    }
}
switch-options {
    vtep-source-interface lo0.0;
    route-distinguisher 192.168.200.1:999;
    vrf-import EVPN_IMPORT;
    vrf-target {
        target:999:999;
        auto {
            import-as 100.0 {
                vni-list all;
            }
        }
    }
}
vlans {
    redtail_dc {
        vlan-id 100;
        l3-interface irb.100;
        vxlan {
            vni 5100;
        }
    }
}
